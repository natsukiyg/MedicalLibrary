#!/bin/bash

# ===== è¨­å®šã“ã“ã‹ã‚‰ =====
REMOTE_USER=natsukiyg
REMOTE_HOST=natsukiyg.sakura.ne.jp
REMOTE_DIR=/home/natsukiyg/MedicalLibrary
# ===== è¨­å®šã“ã“ã¾ã§ =====

echo "ğŸš€ .env.production ã‚’æœ¬ç•ªã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ä¸­..."

# æœ¬ç•ªã«.env.productionã‚’é€ä¿¡
scp .env.production ${REMOTE_USER}@${REMOTE_HOST}:${REMOTE_DIR}/.env.production

# æœ¬ç•ªã‚µãƒ¼ãƒãƒ¼ä¸Šã§ã®å‡¦ç†ã‚’å®Ÿè¡Œ
ssh ${REMOTE_USER}@${REMOTE_HOST} << EOF
  cd ${REMOTE_DIR}
  echo "ğŸ”— .env ã‚’ .env.production ã«ãƒªãƒ³ã‚¯"
  rm -f .env
  ln -s .env.production .env

  echo "ğŸ§¹ Laravel ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢"
  php artisan config:clear
  php artisan cache:clear
  php artisan config:cache

  echo "âœ… æœ¬ç•ªç’°å¢ƒã® .env åæ˜ ãŒå®Œäº†ã—ã¾ã—ãŸ"
EOF